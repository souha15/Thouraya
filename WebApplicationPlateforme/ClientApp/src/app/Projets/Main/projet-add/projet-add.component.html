<app-nav-menu></app-nav-menu>
<!-- Page Content -->
<div class="content">
  <div class="row">
    <div class="col-md-3 col-sm-4">
      <app-side-menu></app-side-menu>
    </div>

    <div class="col-md-9 col-sm-8">
      <app-projet-menu></app-projet-menu>
      <header>
        <h3 class="task-head">إضافة مشروع</h3>
      </header>
      <div class="events1">
        <form class="form-row events-form mb-3" #form="ngForm" autocomplete="off" (submit)="onSubmit(form)">
          <div class="col-md-12 d-flex w-100 justify-content-between">
            <div>
              <label for="devision"><span><i class="fa fa-sitemap"></i></span> القسم</label>
              <select id="devision" name="classe" #classe="ngModel" [(ngModel)]="pr.classe">
                <option [ngValue]="undefined" selected disabled>-اختر-</option>
                <option *ngFor="let item of classeList" value="{{item.nom}}">{{item.nom}}</option>
              </select>
            </div>
            <div>
              <label for="pro-manager"><span><i class="fa fa-user"></i></span> مدير المشروع</label>
              <input type="text" id="pro-manager" name="dirnom" #dirnom="ngModel" [(ngModel)]="pr.dirnom" />

            </div>
            <div>
              <label for="status"><span><i class="fa fa-edit"></i></span> الصفة</label>
              <input type="text" id="status" name="descriptiondir" #descriptiondir="ngModel" [(ngModel)]="pr.descriptiondir" />
            </div>
          </div>
          <div class="col-md-12">
            <label class="main" for="project"><span><i class="fa fa-spinner"></i></span> المشروع</label>
            <input type="text" id="project" class="ml-3" name="titre" #titre="ngModel" [(ngModel)]="pr.titre" required />
            <div *ngIf="titre.invalid && form.submitted && !isValidFormSubmitted" class="alert alert-danger">
              مطلوب المشروع .
            </div>
            <label for="pro-time">مدة المشروع</label>
            <select id="devision" name="moisjours" #moisjours="ngModel" [(ngModel)]="pr.moisjours" required>

              <option [ngValue]="undefined" selected disabled>-يوم / شهر-</option>
              <option value="شهر"> شهر</option>
              <option value="يوم">يوم</option>
            </select>
            &nbsp;&nbsp;
            <div *ngIf="moisjours.invalid && form.submitted && !isValidFormSubmitted" class="alert alert-danger">
              مطلوب مدة المشروع .
            </div>
            &nbsp;&nbsp;<input type="number" min="0" id="pro-time" name="duree" #duree="ngModel" [(ngModel)]="pr.duree" required />    &nbsp;&nbsp;    &nbsp;&nbsp;
            <div *ngIf="duree.invalid && form.submitted && !isValidFormSubmitted" class="alert alert-danger">
              مطلوب مدة المشروع .
            </div>
            <label for="start-date">تاريخ البداية</label>
            <input type="date" id="start-date" name="date" #date="ngModel" [(ngModel)]="pr.date" required />
            <div *ngIf="date.invalid && form.submitted && !isValidFormSubmitted" class="alert alert-danger">
              مطلوب تاريخ البداية .
            </div>
          </div>
          <div class="col-md-12">
            <div class="w-100 text-center">
              <label class="main">
                <span><i class="fa fa-file-invoice-dollar"></i></span>
                تفاصيل الدعم
              </label>
            </div>
            <div class="d-flex w-100 justify-content-between flex-wrap">
              <div>
                <label for="payee">الجهة الداعمة</label>
                <select id="devision" name="orgnom" #orgnom="ngModel" [(ngModel)]="pr.orgnom">
                  <option [ngValue]="undefined" selected disabled>-اختر-</option>
                  <option *ngFor="let item of orSuppList" value="{{item.nom}}">{{item.nom}}</option>
                </select>
              </div>
              <div>
                <label for="amount">مبلغ الدعم</label>
                <input type="number" min="0" id="amount" name="prix" #prix="ngModel" [(ngModel)]="pr.prix" />
              </div>
              <div>
                <label for="pay-method">طريقة الايداع</label>
                <select id="pay-method" name="typeRembourssement" #typeRembourssement="ngModel" [(ngModel)]="pr.typeRembourssement">
                  <option [ngValue]="undefined" selected disabled>-اختر-</option>
                  <option value="1">شيك</option>
                  <option value="2">حوالة</option>
                </select>
              </div>
              <div>
                <label for="check-num">رقم الشيك</label>
                <input type="number"
                       min="0"
                       name="numcheque" #numcheque="ngModel" [(ngModel)]="pr.numcheque"
                       id="check-num" />
              </div>
              <div>
                <label for="account">الحساب</label>
                <select id="account" name="compte" #compte="ngModel" [(ngModel)]="pr.compte">
                  <option [ngValue]="undefined" selected disabled>-اختر-</option>
                  <option *ngFor="let item of compteList" value="{{item.nom}}">{{item.nom}}</option>
                </select>
              </div>
              <div>
                <label for="pay-date">تاريخ الدعم</label>
                <input type="date" id="pay-date" name="datesupport" #datesupport="ngModel" [(ngModel)]="pr.datesupport" />
              </div>
              <div>
                <label for="pay-num">رقم سند القبض</label>
                <input type="number" min="0" id="pay-num" name="numReception" #numReception="ngModel" [(ngModel)]="pr.numReception" />
              </div>
            </div>
          </div>
          <div class="col-md-12 event-team">
            <div class="text-center">
              <label class="main">
                <span><i class="fa fa-hand-holding-usd"></i></span> بنود
                الصرف
              </label>
            </div>
            <label for="work">النشاط</label>
            <select id="work" class="ml-4" name="activite" #activite="ngModel" [(ngModel)]="pay.activite">
              <option [ngValue]="undefined" selected disabled>-اختر-</option>
              <option *ngFor="let item of PayActList" value="{{item.nom}}">{{item.nom}}</option>
            </select>
            <label for="category">الفئة</label>
            <select id="category" class="ml-4" name="categ" #categ="ngModel" [(ngModel)]="pay.categ">
              <option [ngValue]="undefined" selected disabled>-اختر-</option>
              <option *ngFor="let item of PayTypeList" value="{{item.nom}}">{{item.nom}}</option>
            </select>
            <label for="number2">العدد</label>
            <input type="number"
                   class="ml-4"
                   name="nb" #nb="ngModel" [(ngModel)]="pay.nb"
                   id="number2"
                   min="0" />
            <label for="cost2">التكلفة</label>
            <input type="number" id="cost2" min="0" class="ml-4" name="prix" #prix="ngModel" [(ngModel)]="pay.prix" />
            <input class="add-inputs" (click)="addActivite()" type="button" value="اضافة">
            <div class="table-responsive new-table2" *ngIf="paytest">
              <table class="table table-bordered text-center table-striped">
                <thead class="thead-primary">
                  <tr>
                    <th scope="col">#</th>
                    <th scope="col">النشاط</th>
                    <th scope="col">الفئة</th>
                    <th scope="col">العدد</th>
                    <th scope="col">التكلفة</th>
                    <th scope="col">حذف</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let dp of payList ; let i = index">
                    <th scope="row">{{i+1}}</th>
                    <td>{{dp.activite}}</td>
                    <td>{{dp.categ}}</td>
                    <td>{{dp.nb}}</td>
                    <td>{{dp.prix}}</td>
                    <td><a (click)="del1(dp,i)"><i class="fa fa-times" style="color:red;font-size:20px"></i></a></td>
                  </tr>

                </tbody>
              </table>
            </div>
          </div>

          <div class="col-md-12">
            <label class="main" for="stat">
              <span><i class="fa fa-history"></i></span> حالة
              المشروع
            </label>
            <select id="stat" class="ml-4" name="etat" #etat="ngModel" [(ngModel)]="pr.etat">
              <option [ngValue]="undefined" selected disabled>-اختر-</option>
              <option value="نشط">نشط</option>
              <option value="متعثر">متعثر</option>
              <option value="مغلق">مغلق</option>
            </select>
            <label for="resume">تقييم الأداء</label>
            <input type="number" min="0" id="resume" name="evaluation" #evaluation="ngModel" [(ngModel)]="pr.evaluation" />
          </div>
          <div class="col-md-12">
            <label class="main">
              <span><i class="fa fa-file-upload"></i></span>
              المرفقات
            </label>
            <span>

            </span>

            <div class="row">

              <ngx-dropzone (change)="upload1($event);onSelect1($event)" class="dropzone" #inputFile>
                <ngx-dropzone-label class="file-label" for="photos">
                  <span><i class="fa fa-file fa-lg"></i></span> دراسة المشروع
                  <span class="mr-4"><i class="fa fa-upload"></i></span>
                </ngx-dropzone-label>
                <ngx-dropzone-preview *ngFor="let f of files1" [removable]="true" (removed)="onRemove1(f)">
                  <ngx-dropzone-label>{{ f.name }}</ngx-dropzone-label>
                </ngx-dropzone-preview>
              </ngx-dropzone>


              <div>
                <p>&nbsp;</p>
              </div>
              <ngx-dropzone (change)="upload2($event);onSelect2($event)" class="dropzone" #inputFile>
                <ngx-dropzone-label class="file-label" for="photos">
                  <span><i class="fa fa-file fa-lg"></i></span> الإتفاقية
                  <span class="mr-4"><i class="fa fa-upload"></i></span>
                </ngx-dropzone-label>
                <ngx-dropzone-preview *ngFor="let f of files2" [removable]="true" (removed)="onRemove2(f)">
                  <ngx-dropzone-label>{{ f.name }}</ngx-dropzone-label>
                </ngx-dropzone-preview>
              </ngx-dropzone>


              <div>
                <p>&nbsp;</p>
              </div>
              <ngx-dropzone (change)="upload3($event);onSelect3($event)" class="dropzone" #inputFile>
                <ngx-dropzone-label class="file-label" for="photos">
                  <span><i class="fa fa-file fa-lg"></i></span> صورة الشيك
                  <span class="mr-4"><i class="fa fa-upload"></i></span>
                </ngx-dropzone-label>
                <ngx-dropzone-preview *ngFor="let f of files3" [removable]="true" (removed)="onRemove3(f)">
                  <ngx-dropzone-label>{{ f.name }}</ngx-dropzone-label>
                </ngx-dropzone-preview>
              </ngx-dropzone>


              <div>
                <p>&nbsp;</p>
              </div>
              <ngx-dropzone (change)="upload4($event);onSelect4($event)" class="dropzone" #inputFile>
                <ngx-dropzone-label class="file-label" for="photos">
                  <span><i class="fa fa-file fa-lg"></i></span> سند القبض
                  <span class="mr-4"><i class="fa fa-upload"></i></span>
                </ngx-dropzone-label>
                <ngx-dropzone-preview *ngFor="let f of files4" [removable]="true" (removed)="onRemove4(f)">
                  <ngx-dropzone-label>{{ f.name }}</ngx-dropzone-label>
                </ngx-dropzone-preview>
              </ngx-dropzone>


              <div>
                <p>&nbsp;</p>
              </div>
              <ngx-dropzone (change)="upload5($event);onSelect5($event)" class="dropzone" #inputFile>
                <ngx-dropzone-label class="file-label" for="photos">
                  <span><i class="fa fa-file fa-lg"></i></span> كشف
                  الحساب
                  <span class="mr-4"><i class="fa fa-upload"></i></span>
                </ngx-dropzone-label>
                <ngx-dropzone-preview *ngFor="let f of files5" [removable]="true" (removed)="onRemove5(f)">
                  <ngx-dropzone-label>{{ f.name }}</ngx-dropzone-label>
                </ngx-dropzone-preview>
              </ngx-dropzone>

            </div>
          </div>

          <div class="col-md-12">
            <label class="main" for="stat">
              <span><i class="fa fa-file-alt"></i></span>
              التقاریر
            </label>

            <select id="report" class="ml-4" style="width:150px;" name="type" #type="ngModel" [(ngModel)]="rf.type">
              <option [ngValue]="undefined" selected disabled>-اختر-</option>
              <option value="مرحلي">مرحلي</option>
              <option value="ختامي">ختامي</option>
            </select>
            <label for="up-date">تاريخ الرفع</label>
            <input type="date" id="up-date" style="width:150px;" name="date" #date="ngModel" [(ngModel)]="rf.date" />

            <ngx-dropzone (change)="upload6($event);onSelect6($event)" class="dropzone1" #inputFile>
              <ngx-dropzone-label class="file-label" for="photos">
                <span><i class="fa fa-file fa-lg"></i></span>
                التقریر
                <span class="mr-4"><i class="fa fa-upload"></i></span>
              </ngx-dropzone-label>
              <ngx-dropzone-preview *ngFor="let f of files6" [removable]="true" (removed)="onRemove6(f)">
                <ngx-dropzone-label>{{ f.name }}</ngx-dropzone-label>
              </ngx-dropzone-preview>
            </ngx-dropzone>

          </div>
          <div class="col-md-6">
            <label for="results" class="main"><span><i class="fa fa-users-cog"></i></span> التوصیات والملاحظات</label>
            <textarea id="results" class="form-control mb-3" name="remarque" #remarque="ngModel" [(ngModel)]="pr.remarque"></textarea>
          </div>

          <div class="col-12 text-left">
            <input class="btn btn-info px-4" type="submit" value="حفظ" />
          </div>

          <div class="col-md-6">
            <div class="success-msg" *ngIf="succ">
              <i class="fa fa-check"></i>
              {{msg}}
            </div>

            <div class="error-msg" *ngIf="failed">
              <i class="fa fa-times-circle"></i>
              {{msg}}
            </div>
          </div>

        </form>
      </div>
    </div>
  </div>

</div>
<!-- Footer -->
<footer class="text-center">
 <p>كل الحقوق محفوظة لمؤسسة مواهب الخليج  <a class="navbar-brand" href="#"> <img src="assets/images/awal.png" style="width:40px;height:40px;"></a> </p>
</footer>
